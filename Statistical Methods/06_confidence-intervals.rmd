---
title: ''
mainfont: Arial
fontsize: 12pt
documentclass: report
header-includes:
- \PassOptionsToPackage{table}{xcolor}
- \usepackage{caption}
- \usepackage{amssymb}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
- \usepackage[table]{xcolor}
- \usepackage{fancyhdr}
- \usepackage{boldline}
- \usepackage{tipa}
   \definecolor{headergrey}{HTML}{545454}
   \definecolor{msdblue}{HTML}{1C93D1}
   \pagestyle{fancy}
   \setlength\headheight{30pt}
   \rhead{\color{headergrey}\today}
   \fancyhead[L]{\color{headergrey}Moretz, Brandon}
   \fancyhead[C]{\Large\bfseries\color{headergrey}Confidence Intervals}
   \rfoot{\color{headergrey}\thepage}
   \lfoot{\color{headergrey}Chapter 6}
   \fancyfoot[C]{\rmfamily\color{headergrey}Statistical Methods}
geometry: left = 1cm, right = 1cm, top = 2cm, bottom = 3cm
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    fig_caption: yes
    latex_engine: xelatex
editor_options: 
  chunk_output_type: console
---


```{r knitr_setup, include = FALSE}

# DO NOT ADD OR REVISE CODE HERE
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, dev = 'png')
options(knitr.table.format = "latex")

```

```{r report_setup, message = FALSE, warning = FALSE, include = FALSE}

library(data.table, quietly = TRUE, warn.conflicts = FALSE)

assignInNamespace("cedta.pkgEvalsUserCode", c(data.table:::cedta.pkgEvalsUserCode, "rtvs"), "data.table")

library(here, quietly = T, warn.conflicts = F)
library(ggplot2, quietly = T, warn.conflicts = F)
library(ggrepel, quietly = TRUE, warn.conflicts = FALSE)
library(ggthemes, quietly = TRUE, warn.conflicts = FALSE)
library(knitr, quietly = TRUE, warn.conflicts = FALSE)
library(kableExtra, quietly = TRUE, warn.conflicts = FALSE)
library(scales, quietly = TRUE, warn.conflicts = FALSE)
library(pander, quietly = TRUE, warn.conflicts = FALSE)
library(dplyr, quietly = TRUE, warn.conflicts = FALSE)
library(formattable, quietly = TRUE, warn.conflicts = FALSE)
library(grid, quietly = TRUE, warn.conflicts = FALSE)
library(gridExtra, quietly = TRUE, warn.conflicts = FALSE)

options(tinytex.verbose = TRUE)
suppressMessages(library("tidyverse"))

pretty_kable <- function(data, title, dig = 2) {
  kable(data, caption = title, digits = dig) %>%
    kable_styling(bootstrap_options = c("striped", "hover")) %>%
      kableExtra::kable_styling(latex_options = "hold_position")
}

theme_set(theme_light())

# Theme Overrides
theme_update(axis.text.x = element_text(size = 10),
             axis.text.y = element_text(size = 10),
             plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "darkgreen"),
             axis.title = element_text(face = "bold", size = 12, colour = "steelblue4"),
             plot.subtitle = element_text(face = "bold", size = 8, colour = "darkred"),
             legend.title = element_text(size = 12, color = "darkred", face = "bold"),
             legend.position = "right", legend.title.align=0.5,
             panel.border = element_rect(linetype = "solid", 
                                         colour = "lightgray"), 
             plot.margin = unit(c( 0.1, 0.1, 0.1, 0.1), "inches"))

data.dir <- "D:/Projects/Statistical-Computing/datasets/"

```

```{r pander_setup, include = FALSE}

knitr::opts_chunk$set(comment = NA)

panderOptions('table.alignment.default', function(df)
    ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)

```

#### Chapter 6

### 6.1

Explain the meaning of a .95 confidence interval.

_A confidence interval is a statistical measure of the probability coverage a given lies within some interval based upon the observed data._

### 6.2

If the goal is to compute a .80, or .92, or a .98 confidence interval for $\mu$ when $\sigma$ is known, and sampling is from a normal distribution, what values for c should be used in Equation (6.4)?

```{r, echo = T}
pretty_kable(
   data.table( 
      Confidence = c(.8, .92, .98) )[, 
         Val := (1 - (1 - Confidence)/2)][, C := qnorm(Val)] , 
   "Confidence Values")
```

### 6.3

```{r, echo = T}
conf <- function(alpha) {
   c( Lower = (1 - alpha)/2, Upper = 1 - (1 - alpha)/2)   
}
```

Assuming random sampling is from a normal distribution with standard deviation $\sigma = 5$, if the sample mean is $\bar{X} = 45$ based on $n = 25$ participants, what is the 0.95 confidence interval for $\mu$?

```{r, echo = T}
qnorm(conf(.95), mean = 45, sd = 5/sqrt(25))
```

### 6.4

Repeat the previous example, only compute a .99 confidence interval instead.

```{r, echo = T}
qnorm(conf(.99), mean = 45, sd = 5/sqrt(25))
```

### 6.5

A manufacturer claims that their light bulbs have an average life span that follows a normal distribution with $\mu = 1,200$ hours and a standard deviation of $\sigma = 25$. If you randomly test 36 light bulbs and find that their average life span is $\bar{X} = 1,150$, does a .95 confidence interval for $mu$ suggest that the claim $mu = 1,200$ is reasonable?

```{r, echo = T}
qnorm(conf(.95), mean = 1150, sd = 25/sqrt(36))
```

No, 1,200 is outside the bounds of a 95% confidence interval.

### 6.6

Compute a .95 confidence interval for the mean, assuming normality, for the following situations:

a.) $n = 12, \sigma = 22, \bar{X} = 65$

```{r, echo = T}
qnorm(conf(.95), mean = 65, sd = 22/sqrt(12))
```

b.) $n = 22, \sigma = 10, \bar{X} = 185$

```{r, echo = T}
qnorm(conf(.95), mean = 185, sd = 10/sqrt(22))
```

c.) $n = 50, \sigma = 30, \bar{X} = 19$

```{r, echo = T}
qnorm(conf(.95), mean = 19, sd = 30/sqrt(50))
```

\newpage

### 6.7

What happens to the length of a confidence interval for the mean of a normal distribution when the sample size is doubled? In particular, what is the ratio of the lengths?

What is the ratio of the lengths if the sample size is quadrupled?

__Answer__:

In general, For some _x_,

$CI = \mu \pm C\frac{\sigma}{x\sqrt{n}}$

As _x_ increases, the size of the confidence intervals decrease (closer approximations).

### 6.8

The length of a bolt made by a machine parts company has a normal distribution with standard deviation $\sigma$ equal to 0.01 mm. The lengths of four randomly selected bolts are as follows:

20.01, 19.88, 20.00, 19.99

a.) Compute a 0.95 confidence interval for the mean.

```{r, echo = T}
x <- c(20.01, 19.88, 20.00, 19.99)
n <- length(x)
xbar <- mean(x)

qnorm(conf(.95), mean = xbar, sd = 0.01/sqrt(n))
```

b.) Specifications requre a mean lengths $\mu$ of 20.00 mm for the population of bolts. Do the data indicate that this specification is being met?

_No, the 95% confidence interval for the mean does not include 20._

c.) Given that the 0.95 confidence interval contains the value 20, why might it be inappropriate to conclude that the specification is being met?

_Just because the confidence interval includes some value, that does not mean that the population paramter is that value._

### 6.9

The weight of trout sold at a trout farm has a standard deviation of 0.25. Based on a sample of 10 trout, the average weight is 2.10 lbs.

Assume normality and Compute a .99 confidence interval for the mean.

```{r, echo = T}
qnorm(conf(.99), mean = 2.10, sd = .25/sqrt(10))
```

### 6.10

The average bounce of 45 randomly selected tennis balls is found to be $\bar{X} = 1.70$.

Assuming that the standard deviation of the bounce is .30, compute a 0.90 confidence interval for the average bounce assuming normality.

```{r, echo = T}
qnorm(conf(.90), mean = 1.70, sd = .30/sqrt(45))
```

### 6.11

Assuming that the degrees of freedom are 20, find the value t for which:

a.) $P(T \le t) = 0.995$

```{r, echo = T}
qt(.995, df = 20)
```

b.) $P(T \ge t) = 0.025$

```{r, echo = T}
1 - qt(.025, df = 20)
```

c.) $P(-t \le T \le t) = 0.90$

```{r, echo = T}
qt( (1 + .90) / 2, df = 20)
```

### 6.12

Compute a 0.95 confidence interval if

a.) $n = 10, \bar{X} = 26, s = 9$

```{r, echo = T}
26 + qt(conf(.95), df = 9) * 9/sqrt(10)
```

b.) $n = 18, \bar{X} = 132, s = 20$

```{r, echo = T}
132 + qt(conf(.95), df = 17) * 20/sqrt(18)
```

c.) $n = 25, \bar{X} = 52, s = 12$

```{r, echo = T}
52 + qt(conf(.95), df = 24) * 12/sqrt(25)
```

### 6.13

Compute a 0.99 confidence interval if

a.) $n = 10, \bar{X} = 26, s = 9$

```{r, echo = T}
26 + qt(conf(.99), df = 9) * 9/sqrt(10)
```

b.) $n = 18, \bar{X} = 132, s = 20$

```{r, echo = T}
132 + qt(conf(.99), df = 17) * 20/sqrt(18)
```

c.) $n = 25, \bar{X} = 52, s = 12$

```{r, echo = T}
52 + qt(conf(.99), df = 24) * 12/sqrt(25)
```

### 6.14

For a study on self-awareness, the observed values for one of the groups were:

77, 87, 88, 114, 151, 210, 219, 246, 253, 262, 296, 299, 306, 376, 428, 515, 666, 1310, 2611.

Compute a .95 confidence interval for the mean assuming normality.

```{r, echo = T}
x <- c(77,87,88,114,151,210,219,246,253,262,296,299,306,376,428,515, 666,1310,2611)
xbar <- mean(x)
n <- length(x)

xbar + qt(conf(.95), df = n - 1) * sd(x)/sqrt(n)
```

Compare the result to the bootstrap-t confidence interval.

```{r, echo = T}

winsorize <- function( x, trim = .2) {
   n <- length(x)
   
   o <- sort(x)
   g <- floor(trim*n)
   
   o[1:(g+1)] <- o[(g+1)]
   o[(n-g):n] <- o[n-g]
   
   o
}

trimse<-function(x,tr=.2,na.rm=FALSE){
   if(na.rm)x<-x[!is.na(x)]
   trimse <- sqrt(var(winsorize(x,tr)))/((1-2*tr)*sqrt(length(x)))
   trimse
}

nboot <- 2000
alpha <- .95

sims <- matrix(sample(x, size = x*nboot, replace =T), nrow = nboot)
data <- sims - xbar

top <- apply(data, 1, mean)
bot <- apply(data, 1, trimse)

tval <- top/bot
tval <- sort(tval)

icrit <- round((1-alpha)*nboot)

c(Lower = mean(x)+tval[icrit]*trimse(x),
   Upper = mean(x)-tval[icrit]*trimse(x))
```

Why do they differ?

_Student's T gives a shorter confidence interval, however the probability coverage suggest less than 95% coverage._

### 6.15

Rats are subjected to a drug that might affect aggression. Suppose that for a random sample of rats, measures of aggression are found to be:

5, 12, 23, 24, 18, 9, 18, 11, 36, 15

Compute a 0.95 confidence interval for the mean assuming the scores are from a normal distribution.

### 6.16

Suppose $M = 34$ and the McKean-Schrader estimate of the standard error of M is $S_M = 3$.

Compute a .95 confidence interval for the population median.

### 6.17

### 6.18

### 6.19

### 6.20

### 6.21

### 6.22

### 6.23

### 6.24

### 6.25

### 6.26

### 6.27

### 6.28

### 6.29

### 6.30

### 6.31

### 6.32

### 6.33

### 6.34

### 6.35

### 6.36

### 6.37

### 6.38

### 6.39

### 6.40

### 6.41

### 6.42